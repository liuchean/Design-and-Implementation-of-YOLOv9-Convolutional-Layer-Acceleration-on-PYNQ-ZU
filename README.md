# Design-and-Implementation-of-YOLOv9-Convolutional-Layer-Acceleration-on-PYNQ-ZU

### 🔍 專案簡介
本專案實作了 **YOLOv9 物件偵測模型在 FPGA 上的硬體加速架構**，  
目標是透過 **平行運算與記憶體訪問優化**，提升卷積層運算效能，  
使 FPGA 能在邊緣運算中達到高效能與高穩定度的影像辨識加速效果。

---

## 🧠 研究背景
在深度學習的卷積神經網路（CNN）中，卷積運算佔整體計算量的主要部分。  
然而在平行化運算過程中，輸入與權重資料的重複訪問會造成效能瓶頸。  

本研究提出一種 **最佳化平行處理架構（Optimized Parallel Processing Architecture, OPPA）**，  
透過將輸入與權重資料分割為多個部分，降低重複訪問、提升運算單元利用率，  
達成加速卷積層運算與提升 FPGA 資源效率的目標。

---

## ⚙️ 系統架構設計
### 🔸 架構概念
整體系統採用多模組平行運算設計，包含以下特點：

- **輸入與權重分割**：  
  將輸入與權重資料分為四個部分（`I_part1~4`, `W_part1~4`）  
  以降低記憶體存取頻率與共享衝突。
- **多運算模組平行化**：  
  使用四個 `Compute_o` 模組同步進行運算，提升資料吞吐量。
- **資料流優化 (Dataflow)**：  
  運用 HLS dataflow 技術使資料傳輸與運算重疊，降低延遲。
- **參數彈性化設計**：  
  支援多種 Kernel、Stride、Padding 設定，便於應用於不同卷積層。

### 🔹 模組組成
| 模組名稱 | 功能描述 |
|-----------|-----------|
| `conv2dhls()` | 主卷積加速核心，負責輸入、權重與輸出資料流整合 |
| `compute_outputtt()` | DSP 驅動的平行化乘加運算核心 |
| `mix_4030()` | 多輸出組合與加總模組，整合各 Compute_o 結果 |
| AXI Interface | 改良式記憶體介面，減少通道競爭與訪問延遲 |

---

## 💻 實作與開發環境
- **硬體平台**：Xilinx PYNQ-ZU (Zynq UltraScale+)  
- **開發工具**：Vitis HLS、Vivado、PYNQ Framework  
- **開發語言**：C / C++（硬體架構）、Python（控制與驗證）  
- **主要特性**：
  - 模組化設計，支援 Dataflow 架構  
  - 高可重構性，方便後續模型遷移（如 YOLOv8 → YOLOv9）  
  - FPGA 與 ARM 處理器之間的軟硬體協同運算整合  

---

## 📈 效能結果
| 指標項目 | FPGA (PYNQ-ZU) | ARM Cortex-A53 | 提升幅度 |
|-----------|----------------|----------------|-----------|
| **執行時間** | 減少 **54.37%** | baseline | ✅ 效能明顯提升 |
| **運算穩定度（標準差）** | 0.11 | 2.48 | ✅ 穩定度提升 |
| **資源利用率** | DSP / FF 提升，BRAM 減少 | — | ✅ 資源分配更平衡 |

> ⚡ 綜合分析結果顯示：本架構可在維持原模型 **98% 推論準確率** 下，  
> 執行時間縮短至原始版本的 **1/20**，展現出 FPGA 硬體加速的高實用價值。

---

## 🧾 研究論文
> 劉哲安，《基於 FPGA 之 YOLOv9 平行化加速架構設計與實作》，  
> 國立台北大學通訊工程學系碩士論文，2025。

- 研究核心：  
  針對 YOLOv9 模型卷積層的高運算量問題，設計適用於 FPGA 的加速架構。
- 技術貢獻：  
  - 結合多語言開發（C/C++ 與 Python），實現軟硬體協同運算。  
  - 在有限硬體資源下，進行多維度優化（運算單元配置、記憶體策略）。  
  - 完成實際部署與效能測試，驗證可行性與穩定性。

---


