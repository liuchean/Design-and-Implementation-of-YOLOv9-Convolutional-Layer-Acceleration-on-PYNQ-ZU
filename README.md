# Design-and-Implementation-of-YOLOv9-Convolutional-Layer-Acceleration-on-PYNQ-ZU

### 🔍 專案簡介
深度學習（Deep Learning）與人工智慧（Artificial Intelligence, AI）近年來已成為各大科技公司投入的核心研究領域。其中，影像識別技術 因具備廣泛的應用價值而備受關注。在深度學習模型中，卷積神經網路（Convolutional Neural Network, CNN） 是影像辨識的主要架構，而卷積運算則為整體運算中最關鍵且最耗時的部分。由於卷積運算涉及大量重複且複雜的資料處理，傳統以 ARM 或 x86 為主的處理器架構 常面臨運算效能瓶頸。相較之下，FPGA（Field Programmable Gate Array） 具備高度並行運算特性，能有效加速此類運算流程，進而顯著提升邊緣運算的整體效能。

---

🧠 研究背景
#### 深度學習（Deep Learning）與人工智慧（Artificial Intelligence, AI）近年來已成為各大科技公司投入的核心研究領域。其中，影像識別技術 因具備廣泛的應用價值而備受關注。在深度學習模型中，卷積神經網路（Convolutional Neural Network, CNN） 是影像辨識的主要架構，而卷積運算則為整體運算中最關鍵且最耗時的部分。由於卷積運算涉及大量重複且複雜的資料處理，傳統以 ARM 或 x86 為主的處理器架構 常面臨運算效能瓶頸。相較之下，FPGA（Field Programmable Gate Array） 具備高度並行運算特性，能有效加速此類運算流程，進而顯著提升邊緣運算的整體效能。

---

⚙️ 主要系統架構設計
架構說明
本論文提出一種名為 EPIC（Enhanced Partition for Independent Convolution） 的架構優化方案。該方法透過 輸入資料的分割策略，有效解決了卷積運算中需重複載入輸入數據的造成資源不足的問題。EPIC 架構將原先單一的大型卷積模組拆分為 四個可獨立運作的小型卷積模組，使各模組能同時執行運算，並且每個模組內的運算也能同時運算，實現更高層次的平行化。此設計可以充分發揮 FPGA 的高度並行運算能力，大幅強化卷積層的整體執行效能。

- **輸入與權重分割**：  
  將輸入與權重資料分為四個部分（`I_part1~4`, `W_part1~4`）  
  以降低記憶體存取頻率與共享衝突。
- **多運算模組平行化**：  
  使用四個 `Compute_o` 模組同步進行運算，提升資料吞吐量。
- **資料流優化 (Dataflow)**：  
  運用 HLS dataflow 技術使資料傳輸與運算重疊，降低延遲。
- **參數彈性化設計**：  
  支援多種 Kernel、Stride、Padding 設定，便於應用於不同卷積層。

### 🔹 模組組成
| 模組名稱 | 功能描述 |
|-----------|-----------|
| `conv2dhls()` | 主卷積加速核心，負責輸入、權重與輸出資料流整合 |
| `compute_outputtt()` | DSP 驅動的平行化乘加運算核心 |
| `mix_4030()` | 多輸出組合與加總模組，整合各 Compute_o 結果 |
| AXI Interface | 改良式記憶體介面，減少通道競爭與訪問延遲 |

---

## 💻 實作與開發環境
- **硬體平台**：Xilinx PYNQ-ZU (Zynq UltraScale+)  
- **開發工具**：Vitis HLS、Vivado、PYNQ Framework  
- **開發語言**：C / C++（硬體架構）、Python（控制與驗證）  
- **主要特性**：
  - 模組化設計，支援 Dataflow 架構  
  - 高可重構性，方便後續模型遷移（如 YOLOv8 → YOLOv9）  
  - FPGA 與 ARM 處理器之間的軟硬體協同運算整合  

---

## 📈 效能結果
| 指標項目 | FPGA (PYNQ-ZU) | ARM Cortex-A53 | 提升幅度 |
|-----------|----------------|----------------|-----------|
| **執行時間** | 減少 **54.37%** | baseline | ✅ 效能明顯提升 |
| **運算穩定度（標準差）** | 0.11 | 2.48 | ✅ 穩定度提升 |
| **資源利用率** | DSP / FF 提升，BRAM 減少 | — | ✅ 資源分配更平衡 |

> ⚡ 綜合分析結果顯示：本架構可在維持原模型 **98% 推論準確率** 下，  
> 執行時間縮短至原始版本的 **1/20**，展現出 FPGA 硬體加速的高實用價值。

---

## 🧾 研究論文
> 劉哲安，《基於 FPGA 之 YOLOv9 平行化加速架構設計與實作》，  
> 國立台北大學通訊工程學系碩士論文，2025。

- 研究核心：  
  針對 YOLOv9 模型卷積層的高運算量問題，設計適用於 FPGA 的加速架構。
- 技術貢獻：  
  - 結合多語言開發（C/C++ 與 Python），實現軟硬體協同運算。  
  - 在有限硬體資源下，進行多維度優化（運算單元配置、記憶體策略）。  
  - 完成實際部署與效能測試，驗證可行性與穩定性。

---


